import React,{useState,useCallback,useEffect,useRef,useLayoutEffect,useContext,useMemo}from"react";import{useSelector,useStore}from"react-redux";var FeedbackType,QuickFeedbackType,ContentType;!function(e){e[e.END_CLASS=0]="END_CLASS",e[e.LEAVE_CLASS=1]="LEAVE_CLASS"}(FeedbackType||(FeedbackType={})),function(e){e[e.VIDEO=0]="VIDEO",e[e.AUDIO=1]="AUDIO",e[e.PRESENTATION=2]="PRESENTATION",e[e.OTHER=3]="OTHER"}(QuickFeedbackType||(QuickFeedbackType={})),function(e){e.Blank="Blank",e.Stream="Stream",e.Activity="Activity",e.Video="Video",e.Audio="Audio",e.Image="Image",e.Camera="Camera",e.Screen="Screen"}(ContentType||(ContentType={}));const newUserId=e=>e,newDeviceId=e=>e,newActivityStreamId=e=>e,newWebRtcStreamId=e=>e,newTimestamp=e=>e,newTrophyType=e=>e,newUserRole=e=>e;function n(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if("production"!==process.env.NODE_ENV){var o=Y[e],i=o?"function"==typeof o?o.apply(null,r):o:"unknown error nr: "+e;throw Error("[Immer] "+i)}throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function t(e){return!!e&&!!e[Q]}function r(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===Z}(e)||Array.isArray(e)||!!e[L]||!!e.constructor[L]||s(e)||v(e))}function i(e,t,r){void 0===r&&(r=!1),0===o(e)?(r?Object.keys:nn)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function o(e){var t=e[Q];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:s(e)?2:v(e)?3:0}function u(e,t){return 2===o(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){return 2===o(e)?e.get(t):e[t]}function f(e,t,r){var n=o(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function c(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function s(e){return X&&e instanceof Map}function v(e){return q&&e instanceof Set}function p(e){return e.o||e.t}function l(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=tn(e);delete t[Q];for(var r=nn(t),n=0;n<r.length;n++){var o=r[n],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function d(e,n){return void 0===n&&(n=!1),y(e)||t(e)||!r(e)||(o(e)>1&&(e.set=e.add=e.clear=e.delete=h),Object.freeze(e),n&&i(e,(function(e,t){return d(t,!0)}),!0)),e}function h(){n(2)}function y(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function b(e){var t=rn[e];return t||n(18,e),t}function m(e,t){rn[e]||(rn[e]=t)}function _(){return"production"===process.env.NODE_ENV||U||n(0),U}function j(e,t){t&&(b("Patches"),e.u=[],e.s=[],e.v=t)}function O(e){g(e),e.p.forEach(S),e.p=null}function g(e){e===U&&(U=e.l)}function w(e){return U={p:[],l:U,h:e,m:!0,_:0}}function S(e){var t=e[Q];0===t.i||1===t.i?t.j():t.O=!0}function P(e,t){t._=t.p.length;var o=t.p[0],i=void 0!==e&&e!==o;return t.h.g||b("ES5").S(t,e,i),i?(o[Q].P&&(O(t),n(4)),r(e)&&(e=M(t,e),t.l||x(t,e)),t.u&&b("Patches").M(o[Q],e,t.u,t.s)):e=M(t,o,[]),O(t),t.u&&t.v(t.u,t.s),e!==H?e:void 0}function M(e,t,r){if(y(t))return t;var n=t[Q];if(!n)return i(t,(function(o,i){return A(e,n,t,o,i,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return x(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=4===n.i||5===n.i?n.o=l(n.k):n.o;i(3===n.i?new Set(o):o,(function(t,i){return A(e,n,o,t,i,r)})),x(e,o,!1),r&&e.u&&b("Patches").R(n,r,e.u,e.s)}return n.o}function A(e,o,i,s,a,c){if("production"!==process.env.NODE_ENV&&a===i&&n(5),t(a)){var d=M(e,a,c&&o&&3!==o.i&&!u(o.D,s)?c.concat(s):void 0);if(f(i,s,d),!t(d))return;e.m=!1}if(r(a)&&!y(a)){if(!e.h.F&&e._<1)return;M(e,a),o&&o.A.l||x(e,a)}}function x(e,t,r){void 0===r&&(r=!1),e.h.F&&e.m&&d(t,r)}function z(e,t){var r=e[Q];return(r?p(r):e)[t]}function I(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function k(e){e.P||(e.P=!0,e.l&&k(e.l))}function E(e){e.o||(e.o=l(e.t))}function R(e,t,r){var n=s(t)?b("MapSet").N(t,r):v(t)?b("MapSet").T(t,r):e.g?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:_(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=n,i=en;r&&(o=[n],i=on);var s=Proxy.revocable(o,i),a=s.revoke,c=s.proxy;return n.k=c,n.j=a,c}(t,r):b("ES5").J(t,r);return(r?r.A:_()).p.push(n),n}function D(e){return t(e)||n(22,e),function e(t){if(!r(t))return t;var n,s=t[Q],c=o(t);if(s){if(!s.P&&(s.i<4||!b("ES5").K(s)))return s.t;s.I=!0,n=F(t,c),s.I=!1}else n=F(t,c);return i(n,(function(t,r){s&&a(s.t,t)===r||f(n,t,e(r))})),3===c?new Set(n):n}(e)}function F(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return l(e)}function N(){function e(e,t){var r=d[e];return r?r.enumerable=t:d[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[Q];return"production"!==process.env.NODE_ENV&&a(t),en.get(t,e)},set:function(t){var r=this[Q];"production"!==process.env.NODE_ENV&&a(r),en.set(r,e,t)}},r}function r(e){for(var t=e.length-1;t>=0;t--){var r=e[t][Q];if(!r.P)switch(r.i){case 5:s(r)&&k(r);break;case 4:o(r)&&k(r)}}}function o(e){for(var t=e.t,r=e.k,n=nn(r),o=n.length-1;o>=0;o--){var i=n[o];if(i!==Q){var s=t[i];if(void 0===s&&!u(t,i))return!0;var a=r[i],d=a&&a[Q];if(d?d.t!==s:!c(a,s))return!0}}var l=!!t[Q];return n.length!==nn(t).length+(l?0:1)}function s(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}function a(e){e.O&&n(3,JSON.stringify(p(e)))}var d={};m("ES5",{J:function(t,r){var n=Array.isArray(t),o=function(t,r){if(t){for(var n=Array(r.length),o=0;o<r.length;o++)Object.defineProperty(n,""+o,e(o,!0));return n}var i=tn(r);delete i[Q];for(var s=nn(i),a=0;a<s.length;a++){var c=s[a];i[c]=e(c,t||!!i[c].enumerable)}return Object.create(Object.getPrototypeOf(r),i)}(n,t),i={i:n?5:4,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:t,k:o,o:null,O:!1,C:!1};return Object.defineProperty(o,Q,{value:i,writable:!0}),o},S:function(e,n,o){o?t(n)&&n[Q].A===e&&r(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[Q];if(r){var n=r.t,o=r.k,a=r.D,c=r.i;if(4===c)i(o,(function(t){t!==Q&&(void 0!==n[t]||u(n,t)?a[t]||e(o[t]):(a[t]=!0,k(r)))})),i(n,(function(e){void 0!==o[e]||u(o,e)||(a[e]=!1,k(r))}));else if(5===c){if(s(r)&&(k(r),a.length=!0),o.length<n.length)for(var d=o.length;d<n.length;d++)a[d]=!1;else for(var l=n.length;l<o.length;l++)a[l]=!0;for(var f=Math.min(o.length,n.length),p=0;p<f;p++)void 0===a[p]&&e(o[p])}}}}(e.p[0]),r(e.p))},K:function(e){return 4===e.i?o(e):s(e)}})}var G,U,W="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),X="undefined"!=typeof Map,q="undefined"!=typeof Set,B="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,H=W?Symbol.for("immer-nothing"):((G={})["immer-nothing"]=!0,G),L=W?Symbol.for("immer-draftable"):"__$immer_draftable",Q=W?Symbol.for("immer-state"):"__$immer_state",Y={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(e){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+e+"'"},22:function(e){return"'current' expects a draft, got: "+e},23:function(e){return"'original' expects a draft, got: "+e},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},Z=""+Object.prototype.constructor,nn="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,tn=Object.getOwnPropertyDescriptors||function(e){var t={};return nn(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},rn={},en={get:function(e,t){if(t===Q)return e;var n=p(e);if(!u(n,t))return function(e,t,r){var n,o=I(t,r);return o?"value"in o?o.value:null===(n=o.get)||void 0===n?void 0:n.call(e.k):void 0}(e,n,t);var o=n[t];return e.I||!r(o)?o:o===z(e.t,t)?(E(e),e.o[t]=R(e.A.h,o,e)):o},has:function(e,t){return t in p(e)},ownKeys:function(e){return Reflect.ownKeys(p(e))},set:function(e,t,r){var n=I(p(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var o=z(p(e),t),i=null==o?void 0:o[Q];if(i&&i.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(c(r,o)&&(void 0!==r||u(e.t,t)))return!0;E(e),k(e)}return e.o[t]===r&&"number"!=typeof r&&(void 0!==r||t in e.o)||(e.o[t]=r,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==z(e.t,t)||t in e.t?(e.D[t]=!1,E(e),k(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=p(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){n(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){n(12)}},on={};i(en,(function(e,t){on[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),on.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&n(13),en.deleteProperty.call(this,e[0],t)},on.set=function(e,t,r){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&n(14),en.set.call(this,e[0],t,r,e[0])};var un=function(){function e(e){var t=this;this.g=B,this.F=!0,this.produce=function(e,o,i){if("function"==typeof e&&"function"!=typeof o){var s=o;o=e;var a=t;return function(e){var t=this;void 0===e&&(e=s);for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return a.produce(e,(function(e){var r;return(r=o).call.apply(r,[t,e].concat(n))}))}}var c;if("function"!=typeof o&&n(6),void 0!==i&&"function"!=typeof i&&n(7),r(e)){var u=w(t),l=R(t,e,void 0),f=!0;try{c=o(l),f=!1}finally{f?O(u):g(u)}return"undefined"!=typeof Promise&&c instanceof Promise?c.then((function(e){return j(u,i),P(e,u)}),(function(e){throw O(u),e})):(j(u,i),P(c,u))}if(!e||"object"!=typeof e){if((c=o(e))===H)return;return void 0===c&&(c=e),t.F&&d(c,!0),c}n(21,e)},this.produceWithPatches=function(e,r){return"function"==typeof e?function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return t.produceWithPatches(r,(function(t){return e.apply(void 0,[t].concat(o))}))}:[t.produce(e,r,(function(e,t){n=e,o=t})),n,o];var n,o},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var o=e.prototype;return o.createDraft=function(e){r(e)||n(8),t(e)&&(e=D(e));var o=w(this),i=R(this,e,void 0);return i[Q].C=!0,g(o),i},o.finishDraft=function(e,t){var r=e&&e[Q];"production"!==process.env.NODE_ENV&&(r&&r.C||n(9),r.I&&n(10));var o=r.A;return j(o,t),P(void 0,o)},o.setAutoFreeze=function(e){this.F=e},o.setUseProxies=function(e){e&&!B&&n(20),this.g=e},o.applyPatches=function(e,r){var n;for(n=r.length-1;n>=0;n--){var o=r[n];if(0===o.path.length&&"replace"===o.op){e=o.value;break}}var i=b("Patches").$;return t(e)?i(e,r):this.produce(e,(function(e){return i(e,r.slice(n+1))}))},e}(),an=new un,fn=an.produce;an.produceWithPatches.bind(an),an.setAutoFreeze.bind(an),an.setUseProxies.bind(an),an.applyPatches.bind(an),an.createDraft.bind(an),an.finishDraft.bind(an);var createNextState2=fn;function formatProdErrorMessage(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function miniKindOf(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;switch(t){case"boolean":case"string":case"number":case"symbol":case"function":return t}if(Array.isArray(e))return"array";if(isDate(e))return"date";if(isError(e))return"error";var r=ctorName(e);switch(r){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return r}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}function ctorName(e){return"function"==typeof e.constructor?e.constructor.name:null}function isError(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}function isDate(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}function kindOf(e){var t=typeof e;return"production"!==process.env.NODE_ENV&&(t=miniKindOf(e)),t}function warning(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function getUnexpectedStateShapeWarningMessage(e,t,r,n){var o=Object.keys(t),i=r&&r.type===ActionTypes.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===o.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!isPlainObject(e))return"The "+i+' has unexpected type of "'+kindOf(e)+'". Expected argument to be an object with the following keys: "'+o.join('", "')+'"';var s=Object.keys(e).filter((function(e){return!t.hasOwnProperty(e)&&!n[e]}));return s.forEach((function(e){n[e]=!0})),r&&r.type===ActionTypes.REPLACE?void 0:s.length>0?"Unexpected "+(s.length>1?"keys":"key")+' "'+s.join('", "')+'" found in '+i+'. Expected to find one of the known reducer keys instead: "'+o.join('", "')+'". Unexpected keys will be ignored.':void 0}function assertReducerShape(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:ActionTypes.INIT}))throw new Error("production"===process.env.NODE_ENV?formatProdErrorMessage(12):'The slice reducer for key "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:ActionTypes.PROBE_UNKNOWN_ACTION()}))throw new Error("production"===process.env.NODE_ENV?formatProdErrorMessage(13):'The slice reducer for key "'+t+"\" returned undefined when probed with a random type. Don't try to handle '"+ActionTypes.INIT+'\' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}function combineReducers(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];"production"!==process.env.NODE_ENV&&void 0===e[o]&&warning('No reducer provided for key "'+o+'"'),"function"==typeof e[o]&&(r[o]=e[o])}var i,s,a=Object.keys(r);"production"!==process.env.NODE_ENV&&(i={});try{assertReducerShape(r)}catch(e){s=e}return function(e,t){if(void 0===e&&(e={}),s)throw s;if("production"!==process.env.NODE_ENV){var n=getUnexpectedStateShapeWarningMessage(e,r,t,i);n&&warning(n)}for(var o=!1,c={},u=0;u<a.length;u++){var d=a[u],l=r[d],f=e[d],p=l(f,t);if(void 0===p){var h=t&&t.type;throw new Error("production"===process.env.NODE_ENV?formatProdErrorMessage(14):"When called with an action of type "+(h?'"'+String(h)+'"':"(unknown type)")+', the slice reducer for key "'+d+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.')}c[d]=p,o=o||p!==f}return(o=o||a.length!==Object.keys(e).length)?c:e}}function isCrushed(){}"production"!==process.env.NODE_ENV&&"string"==typeof isCrushed.name&&"isCrushed"!==isCrushed.name&&warning('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.');var __extends=(extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},extendStatics(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),extendStatics,__spreadArray=function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e},__defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=function(e,t,r){return t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},__spreadValues=function(e,t){for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var n=0,o=__getOwnPropSymbols(t);n<o.length;n++){r=o[n];__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r])}return e};function createAction(e,t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(t){var o=t.apply(void 0,r);if(!o)throw new Error("prepareAction did not return an object");return __spreadValues(__spreadValues({type:e,payload:o.payload},"meta"in o&&{meta:o.meta}),"error"in o&&{error:o.error})}return{type:e,payload:r[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}function executeReducerBuilderCallback(e){var t,r={},n=[],o={addCase:function(e,i){if("production"!==process.env.NODE_ENV){if(n.length>0)throw new Error("`builder.addCase` should only be called before calling `builder.addMatcher`");if(t)throw new Error("`builder.addCase` should only be called before calling `builder.addDefaultCase`")}var s="string"==typeof e?e:e.type;if(s in r)throw new Error("addCase cannot be called with two reducers for the same action type");return r[s]=i,o},addMatcher:function(e,r){if("production"!==process.env.NODE_ENV&&t)throw new Error("`builder.addMatcher` should only be called before calling `builder.addDefaultCase`");return n.push({matcher:e,reducer:r}),o},addDefaultCase:function(e){if("production"!==process.env.NODE_ENV&&t)throw new Error("`builder.addDefaultCase` can only be called once");return t=e,o}};return e(o),[r,n,t]}function createReducer(e,n,o,i){void 0===o&&(o=[]);var s="function"==typeof n?executeReducerBuilderCallback(n):[n,o,i],a=s[0],c=s[1],u=s[2],d=createNextState2(e,(function(){}));return function(e,n){void 0===e&&(e=d);var o=__spreadArray([a[n.type]],c.filter((function(e){return(0,e.matcher)(n)})).map((function(e){return e.reducer})));return 0===o.filter((function(e){return!!e})).length&&(o=[u]),o.reduce((function(e,o){if(o){var i;if(t(e))return void 0===(i=o(e,n))?e:i;if(r(e))return createNextState2(e,(function(e){return o(e,n)}));if(void 0===(i=o(e,n))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return e}),e)}}function getType2(e,t){return e+"/"+t}function createSlice(e){var t=e.name,r=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var n=e.reducers||{},o="function"==typeof e.extraReducers?executeReducerBuilderCallback(e.extraReducers):[e.extraReducers],i=o[0],s=void 0===i?{}:i,a=o[1],c=void 0===a?[]:a,u=o[2],d=void 0===u?void 0:u,l=Object.keys(n),f={},p={},h={};l.forEach((function(e){var r,o,i=n[e],s=getType2(t,e);"reducer"in i?(r=i.reducer,o=i.prepare):r=i,f[e]=r,p[s]=r,h[e]=o?createAction(s,o):createAction(s)}));var y=createReducer(r,__spreadValues(__spreadValues({},s),p),c,d);return{name:t,reducer:y,actions:h,caseReducers:f}}!function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=e.apply(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o}__extends(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,__spreadArray([void 0],e[0].concat(this)))):new(t.bind.apply(t,__spreadArray([void 0],e.concat(this))))}}(Array),process.env.NODE_ENV,process.env.NODE_ENV,N();const values=e=>Object.values(e);function isAllowedToBecomeHost(e){return"teacher"===e.toLowerCase()}const INITIAL_ROOM_STATE={users:{},devices:{},chatMessages:[],content:{type:ContentType.Blank},hostDeviceId:void 0,classEndTime:void 0},join=(e,t)=>t.payload.state,endClass=(e,t)=>{e.classEndTime=t.payload.timestamp},deviceConnect=(e,t)=>{const{name:r,device:n,role:o}=t.payload;e.devices[n.id]=n;const i=n.userId,s=e.users[i];s?s.deviceIds.push(n.id):e.users[i]={id:i,name:r,role:o,deviceIds:[n.id],trophies:[]},!e.hostDeviceId&&isAllowedToBecomeHost(o)&&(e.hostDeviceId=n.id)},deviceDisconnect=(e,t)=>{const{deviceId:r}=t.payload,n=e.devices[r];if(delete e.devices[r],n&&e.hostDeviceId===n.id){e.hostDeviceId=void 0;const t=Object.keys(e.users);t.sort();for(const r of t){const t=e.users[r];if(!t)continue;const n=t.deviceIds[0];if(n&&isAllowedToBecomeHost(t.role)){e.hostDeviceId=n;break}}}},setHost=(e,t)=>{e.hostDeviceId=t.payload},setContent=(e,t)=>{e.content=t.payload},addChatMessage=(e,t)=>{const r=t.payload;e.chatMessages.push(r)},setActivityStreamId=(e,t)=>{const{deviceId:r,activityStreamId:n}=t.payload,o=e.devices[r];o&&(o.activityStreamID=n)},rewardTrophyToUser=(e,t)=>{const{userId:r,trophy:n}=t.payload;e.users[r]?.trophies.push(n)},rewardTrophyToAll=(e,t)=>{const{trophy:r}=t.payload;values(e.users).forEach((e=>e.trophies.push(r)))},classSliceActionPrefix="class",classSlice=createSlice({name:classSliceActionPrefix,initialState:INITIAL_ROOM_STATE,reducers:{join:join,endClass:endClass,deviceConnect:deviceConnect,deviceDisconnect:deviceDisconnect,setHost:setHost,setContent:setContent,addChatMessage:addChatMessage,setActivityStreamId:setActivityStreamId,rewardTrophyToUser:rewardTrophyToUser,rewardTrophyToAll:rewardTrophyToAll}}),classReducer=classSlice.reducer,classActions=classSlice.actions;function validateChatMessage({text:e,timestamp:t,userId:r}){if(e)if(t){if(r)return{userId:newUserId(r),timestamp:newTimestamp(t),text:e};console.error("IChatMessage is missing userId")}else console.error("IChatMessage is missing timestamp");else console.error("IChatMessage is missing text")}function validateContentType(e){return ContentType[e]}function validateContent(e){if(!e.type)return void console.error("IContent is missing type");if(!e.contentLocation)return void console.error("IContent is missing type");const t=validateContentType(e.type);if(!t)return void console.error(`IContent has an invalid type '${e.type}'`);return{type:t,contentLocation:e.contentLocation}}function validateState(e){const t=[];e.chatMessages?e.chatMessages.forEach((e=>{const r=validateChatMessage(e);r?t.push(r):console.error("IClassState has an invalid chatMessage")})):console.error("IClassState is missing chatMessages");let r={type:ContentType.Blank};if(e.content){const t=validateContent(e.content);t?r=t:console.error("IClassState has an invalid content")}else console.error("IClassState is missing content");const n={};e.devices?Object.values(e.devices).forEach((e=>{const t=validateDevice(e);t?n[t.id]=t:console.error("IClassState has invalid device")})):console.error("IClassState is missing devices");const o={};e.users?Object.values(e.users).forEach((e=>{const t=validateUser(e);if(!t)return void console.error("IClassState has invalid user");const r=t.deviceIds.length;t.deviceIds=t.deviceIds.filter((e=>e in n)),t.deviceIds.length!==r&&console.error("Removed unknown DeviceID from IUser"),o[t.id]=t})):console.error("IClassState is missing users");for(const e of values(n))o.hasOwnProperty(e.userId)||console.error(`Device(${e.id}) references unknown User(${e.userId})`);return{chatMessages:t,content:r,devices:n,users:o,classEndTime:e.classEndedTime?newTimestamp(e.classEndedTime):void 0,hostDeviceId:e.hostDeviceId?newDeviceId(e.hostDeviceId):void 0}}function validateUser(e){if(!e.id)return void console.error("IUser is missing id");if(!e.deviceIds)return void console.error("IUser is missing deviceIds");if(!e.name)return void console.error("IUser is missing name");if(!e.role)return void console.error("IUser is missing role");const t=[];for(const e of t){const r=validateTrophy(e);r&&t.push(r)}return{id:newUserId(e.id),deviceIds:e.deviceIds.map((e=>newDeviceId(e))),name:e.name,role:newUserRole(e.role),trophies:t}}function validateDevice({id:e,activityStreamId:t,userId:r,webRtcStreamIds:n}){if(e){if(r)return{id:newDeviceId(e),userId:newUserId(r),activityStreamID:t?newActivityStreamId(t):void 0,webRTCStreamIDs:n?.map((e=>newWebRtcStreamId(e)))||[]};console.error("IDevice is missing userId")}else console.error("IDevice is missing id")}function validateTrophy(e){if(!e.timestamp)return void console.error("ITrophy is missing trophy.timestamp");if(!e.type)return void console.error("ITrophy is missing trophy.type");return{timestamp:e.timestamp,type:e.type}}function messageToClassAction(e){return e.actvityStreamIdChanged?actvityStreamIdChangedAction(e.actvityStreamIdChanged):e.classEnded?classEndedAction(e.classEnded):e.contentChanged?contentChangedAction(e.contentChanged):e.deviceConnected?deviceConnectedAction(e.deviceConnected):e.deviceDisconnected?deviceDisconnectedAction(e.deviceDisconnected):e.hostChanged?hostChangedAction(e.hostChanged):e.newChatMessage?newChatMessageAction(e.newChatMessage):e.joinEvent?joinAction(e.joinEvent):e.trophyRewardedToAll?trophyRewardedToAllAction(e.trophyRewardedToAll):e.trophyRewardedToUser?trophyRewardedToUserAction(e.trophyRewardedToUser):void 0}function actvityStreamIdChangedAction(e){if(e.deviceId){if(e.activityStreamId)return classActions.setActivityStreamId({deviceId:newDeviceId(e.deviceId),activityStreamId:newActivityStreamId(e.activityStreamId)});console.error("IActivityStreamIdChangedEvent missing activityStreamId")}else console.error("IActivityStreamIdChangedEvent missing deviceId")}function classEndedAction(e){if(!e.timestamp)return void console.error("IClassEndedEvent is missing timestamp");const t=newTimestamp(e.timestamp);return classActions.endClass({timestamp:t})}function contentChangedAction(e){if(!e.content)return void console.error("IContentChangedEvent is missing content");const t=validateContent(e.content);return t?classActions.setContent(t):void 0}function deviceConnectedAction(e){if(!e.name)return void console.error("IDeviceConnectedEvent is missing name");if(!e.role)return void console.error("IDeviceConnectedEvent is missing role");if(!e.device)return void console.error("IDeviceConnectedEvent is missing device");const t=validateDevice(e.device);return t?classActions.deviceConnect({name:e.name,role:newUserRole(e.role),device:t}):void 0}function deviceDisconnectedAction({deviceId:e}){if(e)return classActions.deviceDisconnect({deviceId:newDeviceId(e)});console.error("IDeviceDisconnectedEvent is missing deviceId")}function hostChangedAction(e){if(!e.hostDeviceId)return void console.error("IHostChangedEvent is missing hostDeviceId");const t=newDeviceId(e.hostDeviceId);return classActions.setHost(t)}function newChatMessageAction(e){if(!e.chatMessage)return void console.error("INewChatMessageEvent is missing chatMessage");const t=validateChatMessage(e.chatMessage);return t?classActions.addChatMessage(t):void 0}function joinAction(e){if(!e.state)return void console.error("ISetClassStateEvent is missing state");if(!e.deviceId)return void console.error("ISetClassStateEvent is missing deviceId");const t=validateState(e.state);return t?classActions.join({state:t,deviceId:newDeviceId(e.deviceId)}):void 0}function trophyRewardedToAllAction(e){if(!e.trophy)return void console.error("ITrophyRewardedToAllEvent is missing trophy");const t=validateTrophy(e.trophy);return t?classActions.rewardTrophyToAll({trophy:t}):void 0}function trophyRewardedToUserAction(e){if(!e.userId)return void console.error("ITrophyRewardedToAllEvent is missing userId");if(!e.trophy)return void console.error("ITrophyRewardedToAllEvent is missing trophy");const t=validateTrophy(e.trophy);return t?classActions.rewardTrophyToUser({userId:newUserId(e.userId),trophy:t}):void 0}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends.apply(this,arguments)}"undefined"==typeof Symbol||(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"==typeof Symbol||(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var useIsomorphicLayoutEffect="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?useLayoutEffect:useEffect,useGetter=function(e){var t=useRef(e);return useIsomorphicLayoutEffect((function(){t.current=e})),useCallback((function(){return t.current}),[t])},InitialAsyncState={status:"not-requested",loading:!1,result:void 0,error:void 0},InitialAsyncLoadingState={status:"loading",loading:!0,result:void 0,error:void 0},defaultSetLoading=function(e){return InitialAsyncLoadingState},defaultSetResult=function(e,t){return{status:"success",loading:!1,result:e,error:void 0}},defaultSetError=function(e,t){return{status:"error",loading:!1,result:void 0,error:e}},noop$1=function(){},DefaultOptions={initialState:function(e){return e&&e.executeOnMount?InitialAsyncLoadingState:InitialAsyncState},executeOnMount:!0,executeOnUpdate:!0,setLoading:defaultSetLoading,setResult:defaultSetResult,setError:defaultSetError,onSuccess:noop$1,onError:noop$1},normalizeOptions=function(e){return _extends({},DefaultOptions,{},e)},useAsyncState=function(e){var t=useState((function(){return e.initialState(e)})),r=t[0],n=t[1],o=useCallback((function(){return n(e.initialState(e))}),[n,e]),i=useCallback((function(){return n(e.setLoading(r))}),[r,n]),s=useCallback((function(t){return n(e.setResult(t,r))}),[r,n]),a=useCallback((function(t){return n(e.setError(t,r))}),[r,n]),c=useCallback((function(e){return n(_extends({},r,{},e))}),[r,n]);return{value:r,set:n,merge:c,reset:o,setLoading:i,setResult:s,setError:a}},useIsMounted=function(){var e=useRef(!1);return useEffect((function(){return e.current=!0,function(){e.current=!1}}),[]),function(){return e.current}},useCurrentPromise=function(){var e=useRef(null);return{set:function(t){return e.current=t},get:function(){return e.current},is:function(t){return e.current===t}}},useAsyncInternal=function(e,t,r){!t&&(t=[]);var n=normalizeOptions(r),o=useState(null),i=o[0],s=o[1],a=useAsyncState(n),c=useIsMounted(),u=useCurrentPromise(),d=function(e){return c()&&u.is(e)},l=useGetter((function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=function(){try{return Promise.resolve(e.apply(void 0,r))}catch(e){return Promise.reject(e)}}();return s(r),u.set(i),a.setLoading(),i.then((function(e){d(i)&&a.setResult(e),n.onSuccess(e,{isCurrent:function(){return u.is(i)}})}),(function(e){d(i)&&a.setError(e),n.onError(e,{isCurrent:function(){return u.is(i)}})})),i})),f=useCallback((function(){return l().apply(void 0,arguments)}),[l]),p=!c();return useEffect((function(){var e=function(){return l().apply(void 0,t)};p&&n.executeOnMount&&e(),!p&&n.executeOnUpdate&&e()}),t),_extends({},a.value,{set:a.set,merge:a.merge,reset:a.reset,execute:f,currentPromise:u.get(),currentParams:i})},useAsyncCallback=function(e,t){return useAsyncInternal(e,[],_extends({},t,{executeOnMount:!1,executeOnUpdate:!1}))};const NetworkContext=React.createContext(null);function useJoinClass(){const e=useContext(NetworkContext),{execute:t,status:r}=useAsyncCallback((t=>e.initWs(t)),{onError:e=>console.error(e)});return{joinClass:t,status:r}}function useLeaveClass(){const e=useContext(NetworkContext),{execute:t,status:r}=useAsyncCallback((t=>e.close(4200,t)));return{leaveClass:t,status:r}}function useEndClass(){const{execute:e,status:t}=useNetworkAction((()=>({endClass:{}})));return{endClass:e,status:t}}function useRewardTrophyToAll(){const{execute:e,status:t}=useNetworkAction((e=>({rewardTrophyToAll:{trophy:{timestamp:Date.now(),type:e}}})));return{rewardTrophyToAll:e,status:t}}function useRewardTrophyToUser(){const{execute:e,status:t}=useNetworkAction(((e,t)=>({rewardTrophyToUser:{userId:e,trophy:{timestamp:Date.now(),type:t}}})));return{rewardTrophyToUser:e,status:t}}function useSendChatMessage(){const{execute:e,status:t}=useNetworkAction((e=>({sendChatMessage:{text:e}})));return{sendChatMessage:e,status:t}}function useSetActvityStreamId(){const{execute:e,status:t}=useNetworkAction((e=>({setActvityStreamId:{activityStreamId:e}})));return{setActvityStreamId:e,status:t}}function useSetContent(){const{execute:e,status:t}=useNetworkAction((e=>({setContent:{content:e}})));return{setContent:e,status:t}}function useSetHost(){const{execute:e,status:t}=useNetworkAction((e=>({setHost:{hostDeviceId:e}})));return{setHost:e,status:t}}function useNetworkAction(e){const t=useContext(NetworkContext);return useAsyncCallback((async(...r)=>{const n=e(...r);t.send(n)}))}function useNetworkState(e){const t=useContext(NetworkContext);return useSelector((r=>e(t.selector(r))))}function useNetworkHandler(e,t){const r=useContext(NetworkContext);useEffect((()=>r.onClassAction(e,t)),[r])}NetworkContext.displayName="KidsloopLiveNetwork";let nanoid=(e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let n=63&r[e];t+=n<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n<63?"_":"-"}return t};var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(e,t){for(var r=new Array(arguments.length-1),n=0,o=2,i=!0;o<arguments.length;)r[n++]=arguments[o++];return new Promise((function(o,s){r[n]=function(e){if(i)if(i=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];o.apply(null,t)}};try{e.apply(t||null,r)}catch(e){i&&(i=!1,s(e))}}))}var base64$1={};!function(e){var t=base64$1;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var r=new Array(64),n=new Array(123),o=0;o<64;)n[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;t.encode=function(e,t,n){for(var o,i=null,s=[],a=0,c=0;t<n;){var u=e[t++];switch(c){case 0:s[a++]=r[u>>2],o=(3&u)<<4,c=1;break;case 1:s[a++]=r[o|u>>4],o=(15&u)<<2,c=2;break;case 2:s[a++]=r[o|u>>6],s[a++]=r[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=r[o],s[a++]=61,1===c&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var i="invalid encoding";t.decode=function(e,t,r){for(var o,s=r,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=n[u]))throw Error(i);switch(a){case 0:o=u,a=1;break;case 1:t[r++]=o<<2|(48&u)>>4,o=u,a=2;break;case 2:t[r++]=(15&o)<<4|(60&u)>>2,o=u,a=3;break;case 3:t[r++]=(3&o)<<6|u,a=0}}if(1===a)throw Error(i);return r-s},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}();var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this};var float=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function o(e,n,o){t[0]=e,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3]}function i(e,n,o){t[0]=e,n[o]=r[3],n[o+1]=r[2],n[o+2]=r[1],n[o+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?o:i,e.writeFloatBE=n?i:o,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),o=2*(n>>31)+1,i=n>>>23&255,s=8388607&n;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=r.bind(null,readUintLE),e.readFloatBE=r.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function o(e,n,o){t[0]=e,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3],n[o+4]=r[4],n[o+5]=r[5],n[o+6]=r[6],n[o+7]=r[7]}function i(e,n,o){t[0]=e,n[o]=r[7],n[o+1]=r[6],n[o+2]=r[5],n[o+3]=r[4],n[o+4]=r[3],n[o+5]=r[2],n[o+6]=r[1],n[o+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?o:i,e.writeDoubleBE=n?i:o,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,o,i){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,o,i+t),e(1/n>0?0:2147483648,o,i+r);else if(isNaN(n))e(0,o,i+t),e(2146959360,o,i+r);else if(n>17976931348623157e292)e(0,o,i+t),e((s<<31|2146435072)>>>0,o,i+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,o,i+t),e((s<<31|a/4294967296)>>>0,o,i+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,o,i+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,i+r)}}}function r(e,t,r,n,o){var i=e(n,o+t),s=e(n,o+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=r.bind(null,readUintLE,0,4),e.readDoubleBE=r.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$2={};!function(e){var t=utf8$2;t.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},t.read=function(e,t,r){if(r-t<1)return"";for(var n,o=null,i=[],s=0;t<r;)(n=e[t++])<128?i[s++]=n:n>191&&n<224?i[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(n>>10),i[s++]=56320+(1023&n)):i[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},t.write=function(e,t,r){for(var n,o,i=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&o),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-i}}();var pool_1=pool;function pool(e,t,r){var n=r||8192,o=n>>>1,i=null,s=n;return function(r){if(r<1||r>o)return e(r);s+r>n&&(i=e(n),s=0);var a=t.call(i,s,s+=r);return 7&s&&(s=1+(7|s)),a}}var longbits=LongBits$2,util$5=minimal$1;function LongBits$2(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits$2.zero=new LongBits$2(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits$2.zeroHash="\0\0\0\0\0\0\0\0";LongBits$2.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new LongBits$2(r,n)},LongBits$2.from=function(e){if("number"==typeof e)return LongBits$2.fromNumber(e);if(util$5.isString(e)){if(!util$5.Long)return LongBits$2.fromNumber(parseInt(e,10));e=util$5.Long.fromString(e)}return e.low||e.high?new LongBits$2(e.low>>>0,e.high>>>0):zero},LongBits$2.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},LongBits$2.prototype.toLong=function(e){return util$5.Long?new util$5.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits$2.fromHash=function(e){return e===zeroHash?zero:new LongBits$2((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits$2.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits$2.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits$2.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits$2.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10},function(e){var t=minimal$1;function r(e,t,r){for(var n=Object.keys(t),o=0;o<n.length;++o)void 0!==e[n[o]]&&r||(e[n[o]]=t[n[o]]);return e}function n(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}t.asPromise=aspromise,t.base64=base64$1,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=longbits,t.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}}();var writer=Writer$1,util$4=minimal$1,BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};function writeByte(e,t,r){t[r]=255&e}function writeVarint32(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function writeFixed32(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Writer$1.create=create$1(),Writer$1.alloc=function(e){return new util$4.Array(e)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Op(e,t,r),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer$1.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer$1.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer$1.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function(e){return this._push(util$4.float.writeFloatLE,4,e)},Writer$1.prototype.double=function(e){return this._push(util$4.float.writeDoubleLE,8,e)};var writeBytes=util$4.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};Writer$1.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(util$4.isString(e)){var r=Writer$1.alloc(t=base64.length(e));base64.decode(e,r,0),e=r}return this.uint32(t)._push(writeBytes,t,e)},Writer$1.prototype.string=function(e){var t=utf8$1.length(e);return t?this.uint32(t)._push(utf8$1.write,t,e):this._push(writeByte,1,0)},Writer$1.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer$1.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},Writer$1.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=minimal$1;function BufferWriter(){Writer.call(this)}function writeStringBuffer(e,t,r){e.length<40?util$3.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&"set"===util$3.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},BufferWriter.prototype.bytes=function(e){util$3.isString(e)&&(e=util$3._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this},BufferWriter.prototype.string=function(e){var t=util$3.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter._configure();var reader=Reader$1,util$2=minimal$1,BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create=function(){return util$2.Buffer?function(e){return(Reader$1.create=function(e){return util$2.Buffer.isBuffer(e)?new BufferReader$1(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.create=create(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader$1.prototype.int32=function(){return 0|this.uint32()},Reader$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader$1.prototype.bool=function(){return 0!==this.uint32()},Reader$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader$1.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},Reader$1.prototype.string=function(){var e=this.bytes();return utf8.read(e,0,e.length)},Reader$1.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create(),BufferReader$1._configure();var t=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=minimal$1;function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure();var rpc={},service=Service,util=minimal$1,exports;function Service(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,r,n,o,i){if(!o)throw TypeError("request must be specified");var s=this;if(!i)return util.asPromise(e,s,t,r,n,o);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return s.emit("error",e,t),i(e);if(null!==r){if(!(r instanceof n))try{r=n[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),i(e)}return s.emit("data",r,t),i(null,r)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){i(e)}),0)}else setTimeout((function(){i(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},exports=rpc,exports.Service=service;var roots={};!function(e){var t=indexMinimal;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=minimal$1,t.rpc=rpc,t.roots=roots,t.configure=r,r()}();var minimal=indexMinimal,$protobuf=minimal,$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={});$root.ClassRequest=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.requestId="",e.prototype.endClass=null,e.prototype.setHost=null,e.prototype.setContent=null,e.prototype.setActvityStreamId=null,e.prototype.rewardTrophyToUser=null,e.prototype.rewardTrophyToAll=null,e.prototype.sendChatMessage=null,Object.defineProperty(e.prototype,"command",{get:$util.oneOfGetter(t=["endClass","setHost","setContent","setActvityStreamId","rewardTrophyToUser","rewardTrophyToAll","sendChatMessage"]),set:$util.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.requestId&&Object.hasOwnProperty.call(e,"requestId")&&t.uint32(10).string(e.requestId),null!=e.endClass&&Object.hasOwnProperty.call(e,"endClass")&&$root.EndClassCommand.encode(e.endClass,t.uint32(50).fork()).ldelim(),null!=e.setHost&&Object.hasOwnProperty.call(e,"setHost")&&$root.SetHostCommand.encode(e.setHost,t.uint32(58).fork()).ldelim(),null!=e.setContent&&Object.hasOwnProperty.call(e,"setContent")&&$root.SetContentCommand.encode(e.setContent,t.uint32(66).fork()).ldelim(),null!=e.setActvityStreamId&&Object.hasOwnProperty.call(e,"setActvityStreamId")&&$root.SetActivityStreamIdCommand.encode(e.setActvityStreamId,t.uint32(74).fork()).ldelim(),null!=e.rewardTrophyToUser&&Object.hasOwnProperty.call(e,"rewardTrophyToUser")&&$root.RewardTrophyToUserCommand.encode(e.rewardTrophyToUser,t.uint32(82).fork()).ldelim(),null!=e.rewardTrophyToAll&&Object.hasOwnProperty.call(e,"rewardTrophyToAll")&&$root.RewardTrophyToAllCommand.encode(e.rewardTrophyToAll,t.uint32(90).fork()).ldelim(),null!=e.sendChatMessage&&Object.hasOwnProperty.call(e,"sendChatMessage")&&$root.SendChatMessageCommand.encode(e.sendChatMessage,t.uint32(98).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ClassRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.requestId=e.string();break;case 6:n.endClass=$root.EndClassCommand.decode(e,e.uint32());break;case 7:n.setHost=$root.SetHostCommand.decode(e,e.uint32());break;case 8:n.setContent=$root.SetContentCommand.decode(e,e.uint32());break;case 9:n.setActvityStreamId=$root.SetActivityStreamIdCommand.decode(e,e.uint32());break;case 10:n.rewardTrophyToUser=$root.RewardTrophyToUserCommand.decode(e,e.uint32());break;case 11:n.rewardTrophyToAll=$root.RewardTrophyToAllCommand.decode(e,e.uint32());break;case 12:n.sendChatMessage=$root.SendChatMessageCommand.decode(e,e.uint32());break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.requestId&&e.hasOwnProperty("requestId")&&!$util.isString(e.requestId))return"requestId: string expected";if(null!=e.endClass&&e.hasOwnProperty("endClass")&&(t.command=1,r=$root.EndClassCommand.verify(e.endClass)))return"endClass."+r;if(null!=e.setHost&&e.hasOwnProperty("setHost")){if(1===t.command)return"command: multiple values";if(t.command=1,r=$root.SetHostCommand.verify(e.setHost))return"setHost."+r}if(null!=e.setContent&&e.hasOwnProperty("setContent")){if(1===t.command)return"command: multiple values";if(t.command=1,r=$root.SetContentCommand.verify(e.setContent))return"setContent."+r}if(null!=e.setActvityStreamId&&e.hasOwnProperty("setActvityStreamId")){if(1===t.command)return"command: multiple values";if(t.command=1,r=$root.SetActivityStreamIdCommand.verify(e.setActvityStreamId))return"setActvityStreamId."+r}if(null!=e.rewardTrophyToUser&&e.hasOwnProperty("rewardTrophyToUser")){if(1===t.command)return"command: multiple values";if(t.command=1,r=$root.RewardTrophyToUserCommand.verify(e.rewardTrophyToUser))return"rewardTrophyToUser."+r}if(null!=e.rewardTrophyToAll&&e.hasOwnProperty("rewardTrophyToAll")){if(1===t.command)return"command: multiple values";if(t.command=1,r=$root.RewardTrophyToAllCommand.verify(e.rewardTrophyToAll))return"rewardTrophyToAll."+r}if(null!=e.sendChatMessage&&e.hasOwnProperty("sendChatMessage")){if(1===t.command)return"command: multiple values";var r;if(t.command=1,r=$root.SendChatMessageCommand.verify(e.sendChatMessage))return"sendChatMessage."+r}return null},e.fromObject=function(e){if(e instanceof $root.ClassRequest)return e;var t=new $root.ClassRequest;if(null!=e.requestId&&(t.requestId=String(e.requestId)),null!=e.endClass){if("object"!=typeof e.endClass)throw TypeError(".ClassRequest.endClass: object expected");t.endClass=$root.EndClassCommand.fromObject(e.endClass)}if(null!=e.setHost){if("object"!=typeof e.setHost)throw TypeError(".ClassRequest.setHost: object expected");t.setHost=$root.SetHostCommand.fromObject(e.setHost)}if(null!=e.setContent){if("object"!=typeof e.setContent)throw TypeError(".ClassRequest.setContent: object expected");t.setContent=$root.SetContentCommand.fromObject(e.setContent)}if(null!=e.setActvityStreamId){if("object"!=typeof e.setActvityStreamId)throw TypeError(".ClassRequest.setActvityStreamId: object expected");t.setActvityStreamId=$root.SetActivityStreamIdCommand.fromObject(e.setActvityStreamId)}if(null!=e.rewardTrophyToUser){if("object"!=typeof e.rewardTrophyToUser)throw TypeError(".ClassRequest.rewardTrophyToUser: object expected");t.rewardTrophyToUser=$root.RewardTrophyToUserCommand.fromObject(e.rewardTrophyToUser)}if(null!=e.rewardTrophyToAll){if("object"!=typeof e.rewardTrophyToAll)throw TypeError(".ClassRequest.rewardTrophyToAll: object expected");t.rewardTrophyToAll=$root.RewardTrophyToAllCommand.fromObject(e.rewardTrophyToAll)}if(null!=e.sendChatMessage){if("object"!=typeof e.sendChatMessage)throw TypeError(".ClassRequest.sendChatMessage: object expected");t.sendChatMessage=$root.SendChatMessageCommand.fromObject(e.sendChatMessage)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.requestId=""),null!=e.requestId&&e.hasOwnProperty("requestId")&&(r.requestId=e.requestId),null!=e.endClass&&e.hasOwnProperty("endClass")&&(r.endClass=$root.EndClassCommand.toObject(e.endClass,t),t.oneofs&&(r.command="endClass")),null!=e.setHost&&e.hasOwnProperty("setHost")&&(r.setHost=$root.SetHostCommand.toObject(e.setHost,t),t.oneofs&&(r.command="setHost")),null!=e.setContent&&e.hasOwnProperty("setContent")&&(r.setContent=$root.SetContentCommand.toObject(e.setContent,t),t.oneofs&&(r.command="setContent")),null!=e.setActvityStreamId&&e.hasOwnProperty("setActvityStreamId")&&(r.setActvityStreamId=$root.SetActivityStreamIdCommand.toObject(e.setActvityStreamId,t),t.oneofs&&(r.command="setActvityStreamId")),null!=e.rewardTrophyToUser&&e.hasOwnProperty("rewardTrophyToUser")&&(r.rewardTrophyToUser=$root.RewardTrophyToUserCommand.toObject(e.rewardTrophyToUser,t),t.oneofs&&(r.command="rewardTrophyToUser")),null!=e.rewardTrophyToAll&&e.hasOwnProperty("rewardTrophyToAll")&&(r.rewardTrophyToAll=$root.RewardTrophyToAllCommand.toObject(e.rewardTrophyToAll,t),t.oneofs&&(r.command="rewardTrophyToAll")),null!=e.sendChatMessage&&e.hasOwnProperty("sendChatMessage")&&(r.sendChatMessage=$root.SendChatMessageCommand.toObject(e.sendChatMessage,t),t.oneofs&&(r.command="sendChatMessage")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ClassResponse=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.error="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ClassResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.id=e.string();break;case 2:n.error=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id)?"id: string expected":null!=e.error&&e.hasOwnProperty("error")&&!$util.isString(e.error)?"error: string expected":null},e.fromObject=function(e){if(e instanceof $root.ClassResponse)return e;var t=new $root.ClassResponse;return null!=e.id&&(t.id=String(e.id)),null!=e.error&&(t.error=String(e.error)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.id="",r.error=""),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.error&&e.hasOwnProperty("error")&&(r.error=e.error),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ClassMessage=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.response=null,e.prototype.joinEvent=null,e.prototype.deviceConnected=null,e.prototype.deviceDisconnected=null,e.prototype.classEnded=null,e.prototype.hostChanged=null,e.prototype.contentChanged=null,e.prototype.actvityStreamIdChanged=null,e.prototype.trophyRewardedToUser=null,e.prototype.trophyRewardedToAll=null,e.prototype.newChatMessage=null,Object.defineProperty(e.prototype,"event",{get:$util.oneOfGetter(t=["joinEvent","deviceConnected","deviceDisconnected","classEnded","hostChanged","contentChanged","actvityStreamIdChanged","trophyRewardedToUser","trophyRewardedToAll","newChatMessage"]),set:$util.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.response&&Object.hasOwnProperty.call(e,"response")&&$root.ClassResponse.encode(e.response,t.uint32(10).fork()).ldelim(),null!=e.joinEvent&&Object.hasOwnProperty.call(e,"joinEvent")&&$root.JoinEvent.encode(e.joinEvent,t.uint32(26).fork()).ldelim(),null!=e.deviceConnected&&Object.hasOwnProperty.call(e,"deviceConnected")&&$root.DeviceConnectedEvent.encode(e.deviceConnected,t.uint32(34).fork()).ldelim(),null!=e.deviceDisconnected&&Object.hasOwnProperty.call(e,"deviceDisconnected")&&$root.DeviceDisconnectedEvent.encode(e.deviceDisconnected,t.uint32(42).fork()).ldelim(),null!=e.classEnded&&Object.hasOwnProperty.call(e,"classEnded")&&$root.ClassEndedEvent.encode(e.classEnded,t.uint32(50).fork()).ldelim(),null!=e.hostChanged&&Object.hasOwnProperty.call(e,"hostChanged")&&$root.HostChangedEvent.encode(e.hostChanged,t.uint32(58).fork()).ldelim(),null!=e.contentChanged&&Object.hasOwnProperty.call(e,"contentChanged")&&$root.ContentChangedEvent.encode(e.contentChanged,t.uint32(66).fork()).ldelim(),null!=e.actvityStreamIdChanged&&Object.hasOwnProperty.call(e,"actvityStreamIdChanged")&&$root.ActivityStreamIdChangedEvent.encode(e.actvityStreamIdChanged,t.uint32(74).fork()).ldelim(),null!=e.trophyRewardedToUser&&Object.hasOwnProperty.call(e,"trophyRewardedToUser")&&$root.TrophyRewardedToUserEvent.encode(e.trophyRewardedToUser,t.uint32(82).fork()).ldelim(),null!=e.trophyRewardedToAll&&Object.hasOwnProperty.call(e,"trophyRewardedToAll")&&$root.TrophyRewardedToAllEvent.encode(e.trophyRewardedToAll,t.uint32(90).fork()).ldelim(),null!=e.newChatMessage&&Object.hasOwnProperty.call(e,"newChatMessage")&&$root.NewChatMessageEvent.encode(e.newChatMessage,t.uint32(98).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ClassMessage;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.response=$root.ClassResponse.decode(e,e.uint32());break;case 3:n.joinEvent=$root.JoinEvent.decode(e,e.uint32());break;case 4:n.deviceConnected=$root.DeviceConnectedEvent.decode(e,e.uint32());break;case 5:n.deviceDisconnected=$root.DeviceDisconnectedEvent.decode(e,e.uint32());break;case 6:n.classEnded=$root.ClassEndedEvent.decode(e,e.uint32());break;case 7:n.hostChanged=$root.HostChangedEvent.decode(e,e.uint32());break;case 8:n.contentChanged=$root.ContentChangedEvent.decode(e,e.uint32());break;case 9:n.actvityStreamIdChanged=$root.ActivityStreamIdChangedEvent.decode(e,e.uint32());break;case 10:n.trophyRewardedToUser=$root.TrophyRewardedToUserEvent.decode(e,e.uint32());break;case 11:n.trophyRewardedToAll=$root.TrophyRewardedToAllEvent.decode(e,e.uint32());break;case 12:n.newChatMessage=$root.NewChatMessageEvent.decode(e,e.uint32());break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.response&&e.hasOwnProperty("response")&&(r=$root.ClassResponse.verify(e.response)))return"response."+r;if(null!=e.joinEvent&&e.hasOwnProperty("joinEvent")&&(t.event=1,r=$root.JoinEvent.verify(e.joinEvent)))return"joinEvent."+r;if(null!=e.deviceConnected&&e.hasOwnProperty("deviceConnected")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.DeviceConnectedEvent.verify(e.deviceConnected))return"deviceConnected."+r}if(null!=e.deviceDisconnected&&e.hasOwnProperty("deviceDisconnected")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.DeviceDisconnectedEvent.verify(e.deviceDisconnected))return"deviceDisconnected."+r}if(null!=e.classEnded&&e.hasOwnProperty("classEnded")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.ClassEndedEvent.verify(e.classEnded))return"classEnded."+r}if(null!=e.hostChanged&&e.hasOwnProperty("hostChanged")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.HostChangedEvent.verify(e.hostChanged))return"hostChanged."+r}if(null!=e.contentChanged&&e.hasOwnProperty("contentChanged")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.ContentChangedEvent.verify(e.contentChanged))return"contentChanged."+r}if(null!=e.actvityStreamIdChanged&&e.hasOwnProperty("actvityStreamIdChanged")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.ActivityStreamIdChangedEvent.verify(e.actvityStreamIdChanged))return"actvityStreamIdChanged."+r}if(null!=e.trophyRewardedToUser&&e.hasOwnProperty("trophyRewardedToUser")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.TrophyRewardedToUserEvent.verify(e.trophyRewardedToUser))return"trophyRewardedToUser."+r}if(null!=e.trophyRewardedToAll&&e.hasOwnProperty("trophyRewardedToAll")){if(1===t.event)return"event: multiple values";if(t.event=1,r=$root.TrophyRewardedToAllEvent.verify(e.trophyRewardedToAll))return"trophyRewardedToAll."+r}if(null!=e.newChatMessage&&e.hasOwnProperty("newChatMessage")){if(1===t.event)return"event: multiple values";var r;if(t.event=1,r=$root.NewChatMessageEvent.verify(e.newChatMessage))return"newChatMessage."+r}return null},e.fromObject=function(e){if(e instanceof $root.ClassMessage)return e;var t=new $root.ClassMessage;if(null!=e.response){if("object"!=typeof e.response)throw TypeError(".ClassMessage.response: object expected");t.response=$root.ClassResponse.fromObject(e.response)}if(null!=e.joinEvent){if("object"!=typeof e.joinEvent)throw TypeError(".ClassMessage.joinEvent: object expected");t.joinEvent=$root.JoinEvent.fromObject(e.joinEvent)}if(null!=e.deviceConnected){if("object"!=typeof e.deviceConnected)throw TypeError(".ClassMessage.deviceConnected: object expected");t.deviceConnected=$root.DeviceConnectedEvent.fromObject(e.deviceConnected)}if(null!=e.deviceDisconnected){if("object"!=typeof e.deviceDisconnected)throw TypeError(".ClassMessage.deviceDisconnected: object expected");t.deviceDisconnected=$root.DeviceDisconnectedEvent.fromObject(e.deviceDisconnected)}if(null!=e.classEnded){if("object"!=typeof e.classEnded)throw TypeError(".ClassMessage.classEnded: object expected");t.classEnded=$root.ClassEndedEvent.fromObject(e.classEnded)}if(null!=e.hostChanged){if("object"!=typeof e.hostChanged)throw TypeError(".ClassMessage.hostChanged: object expected");t.hostChanged=$root.HostChangedEvent.fromObject(e.hostChanged)}if(null!=e.contentChanged){if("object"!=typeof e.contentChanged)throw TypeError(".ClassMessage.contentChanged: object expected");t.contentChanged=$root.ContentChangedEvent.fromObject(e.contentChanged)}if(null!=e.actvityStreamIdChanged){if("object"!=typeof e.actvityStreamIdChanged)throw TypeError(".ClassMessage.actvityStreamIdChanged: object expected");t.actvityStreamIdChanged=$root.ActivityStreamIdChangedEvent.fromObject(e.actvityStreamIdChanged)}if(null!=e.trophyRewardedToUser){if("object"!=typeof e.trophyRewardedToUser)throw TypeError(".ClassMessage.trophyRewardedToUser: object expected");t.trophyRewardedToUser=$root.TrophyRewardedToUserEvent.fromObject(e.trophyRewardedToUser)}if(null!=e.trophyRewardedToAll){if("object"!=typeof e.trophyRewardedToAll)throw TypeError(".ClassMessage.trophyRewardedToAll: object expected");t.trophyRewardedToAll=$root.TrophyRewardedToAllEvent.fromObject(e.trophyRewardedToAll)}if(null!=e.newChatMessage){if("object"!=typeof e.newChatMessage)throw TypeError(".ClassMessage.newChatMessage: object expected");t.newChatMessage=$root.NewChatMessageEvent.fromObject(e.newChatMessage)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.response=null),null!=e.response&&e.hasOwnProperty("response")&&(r.response=$root.ClassResponse.toObject(e.response,t)),null!=e.joinEvent&&e.hasOwnProperty("joinEvent")&&(r.joinEvent=$root.JoinEvent.toObject(e.joinEvent,t),t.oneofs&&(r.event="joinEvent")),null!=e.deviceConnected&&e.hasOwnProperty("deviceConnected")&&(r.deviceConnected=$root.DeviceConnectedEvent.toObject(e.deviceConnected,t),t.oneofs&&(r.event="deviceConnected")),null!=e.deviceDisconnected&&e.hasOwnProperty("deviceDisconnected")&&(r.deviceDisconnected=$root.DeviceDisconnectedEvent.toObject(e.deviceDisconnected,t),t.oneofs&&(r.event="deviceDisconnected")),null!=e.classEnded&&e.hasOwnProperty("classEnded")&&(r.classEnded=$root.ClassEndedEvent.toObject(e.classEnded,t),t.oneofs&&(r.event="classEnded")),null!=e.hostChanged&&e.hasOwnProperty("hostChanged")&&(r.hostChanged=$root.HostChangedEvent.toObject(e.hostChanged,t),t.oneofs&&(r.event="hostChanged")),null!=e.contentChanged&&e.hasOwnProperty("contentChanged")&&(r.contentChanged=$root.ContentChangedEvent.toObject(e.contentChanged,t),t.oneofs&&(r.event="contentChanged")),null!=e.actvityStreamIdChanged&&e.hasOwnProperty("actvityStreamIdChanged")&&(r.actvityStreamIdChanged=$root.ActivityStreamIdChangedEvent.toObject(e.actvityStreamIdChanged,t),t.oneofs&&(r.event="actvityStreamIdChanged")),null!=e.trophyRewardedToUser&&e.hasOwnProperty("trophyRewardedToUser")&&(r.trophyRewardedToUser=$root.TrophyRewardedToUserEvent.toObject(e.trophyRewardedToUser,t),t.oneofs&&(r.event="trophyRewardedToUser")),null!=e.trophyRewardedToAll&&e.hasOwnProperty("trophyRewardedToAll")&&(r.trophyRewardedToAll=$root.TrophyRewardedToAllEvent.toObject(e.trophyRewardedToAll,t),t.oneofs&&(r.event="trophyRewardedToAll")),null!=e.newChatMessage&&e.hasOwnProperty("newChatMessage")&&(r.newChatMessage=$root.NewChatMessageEvent.toObject(e.newChatMessage,t),t.oneofs&&(r.event="newChatMessage")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.EndClassCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.EndClassCommand;e.pos<r;){var o=e.uint32();e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof $root.EndClassCommand?e:new $root.EndClassCommand},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.SetHostCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.hostDeviceId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.hostDeviceId&&Object.hasOwnProperty.call(e,"hostDeviceId")&&t.uint32(10).string(e.hostDeviceId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.SetHostCommand;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.hostDeviceId=e.string();else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.hostDeviceId&&e.hasOwnProperty("hostDeviceId")&&!$util.isString(e.hostDeviceId)?"hostDeviceId: string expected":null},e.fromObject=function(e){if(e instanceof $root.SetHostCommand)return e;var t=new $root.SetHostCommand;return null!=e.hostDeviceId&&(t.hostDeviceId=String(e.hostDeviceId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.hostDeviceId=""),null!=e.hostDeviceId&&e.hasOwnProperty("hostDeviceId")&&(r.hostDeviceId=e.hostDeviceId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.SetContentCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.content=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&$root.Content.encode(e.content,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.SetContentCommand;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.content=$root.Content.decode(e,e.uint32());else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.content&&e.hasOwnProperty("content")){var t=$root.Content.verify(e.content);if(t)return"content."+t}return null},e.fromObject=function(e){if(e instanceof $root.SetContentCommand)return e;var t=new $root.SetContentCommand;if(null!=e.content){if("object"!=typeof e.content)throw TypeError(".SetContentCommand.content: object expected");t.content=$root.Content.fromObject(e.content)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.content=null),null!=e.content&&e.hasOwnProperty("content")&&(r.content=$root.Content.toObject(e.content,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.SetActivityStreamIdCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.activityStreamId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.activityStreamId&&Object.hasOwnProperty.call(e,"activityStreamId")&&t.uint32(10).string(e.activityStreamId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.SetActivityStreamIdCommand;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.activityStreamId=e.string();else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.activityStreamId&&e.hasOwnProperty("activityStreamId")&&!$util.isString(e.activityStreamId)?"activityStreamId: string expected":null},e.fromObject=function(e){if(e instanceof $root.SetActivityStreamIdCommand)return e;var t=new $root.SetActivityStreamIdCommand;return null!=e.activityStreamId&&(t.activityStreamId=String(e.activityStreamId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.activityStreamId=""),null!=e.activityStreamId&&e.hasOwnProperty("activityStreamId")&&(r.activityStreamId=e.activityStreamId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.RewardTrophyToUserCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.userId="",e.prototype.trophy=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(10).string(e.userId),null!=e.trophy&&Object.hasOwnProperty.call(e,"trophy")&&$root.Trophy.encode(e.trophy,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.RewardTrophyToUserCommand;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.userId=e.string();break;case 2:n.trophy=$root.Trophy.decode(e,e.uint32());break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.userId&&e.hasOwnProperty("userId")&&!$util.isString(e.userId))return"userId: string expected";if(null!=e.trophy&&e.hasOwnProperty("trophy")){var t=$root.Trophy.verify(e.trophy);if(t)return"trophy."+t}return null},e.fromObject=function(e){if(e instanceof $root.RewardTrophyToUserCommand)return e;var t=new $root.RewardTrophyToUserCommand;if(null!=e.userId&&(t.userId=String(e.userId)),null!=e.trophy){if("object"!=typeof e.trophy)throw TypeError(".RewardTrophyToUserCommand.trophy: object expected");t.trophy=$root.Trophy.fromObject(e.trophy)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.userId="",r.trophy=null),null!=e.userId&&e.hasOwnProperty("userId")&&(r.userId=e.userId),null!=e.trophy&&e.hasOwnProperty("trophy")&&(r.trophy=$root.Trophy.toObject(e.trophy,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.RewardTrophyToAllCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.trophy=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.trophy&&Object.hasOwnProperty.call(e,"trophy")&&$root.Trophy.encode(e.trophy,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.RewardTrophyToAllCommand;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.trophy=$root.Trophy.decode(e,e.uint32());else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.trophy&&e.hasOwnProperty("trophy")){var t=$root.Trophy.verify(e.trophy);if(t)return"trophy."+t}return null},e.fromObject=function(e){if(e instanceof $root.RewardTrophyToAllCommand)return e;var t=new $root.RewardTrophyToAllCommand;if(null!=e.trophy){if("object"!=typeof e.trophy)throw TypeError(".RewardTrophyToAllCommand.trophy: object expected");t.trophy=$root.Trophy.fromObject(e.trophy)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.trophy=null),null!=e.trophy&&e.hasOwnProperty("trophy")&&(r.trophy=$root.Trophy.toObject(e.trophy,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.SendChatMessageCommand=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.text="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(10).string(e.text),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.SendChatMessageCommand;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.text=e.string();else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!$util.isString(e.text)?"text: string expected":null},e.fromObject=function(e){if(e instanceof $root.SendChatMessageCommand)return e;var t=new $root.SendChatMessageCommand;return null!=e.text&&(t.text=String(e.text)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.text=""),null!=e.text&&e.hasOwnProperty("text")&&(r.text=e.text),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.JoinEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.state=null,e.prototype.deviceId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&$root.ClassState.encode(e.state,t.uint32(10).fork()).ldelim(),null!=e.deviceId&&Object.hasOwnProperty.call(e,"deviceId")&&t.uint32(18).string(e.deviceId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.JoinEvent;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.state=$root.ClassState.decode(e,e.uint32());break;case 2:n.deviceId=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.state&&e.hasOwnProperty("state")){var t=$root.ClassState.verify(e.state);if(t)return"state."+t}return null!=e.deviceId&&e.hasOwnProperty("deviceId")&&!$util.isString(e.deviceId)?"deviceId: string expected":null},e.fromObject=function(e){if(e instanceof $root.JoinEvent)return e;var t=new $root.JoinEvent;if(null!=e.state){if("object"!=typeof e.state)throw TypeError(".JoinEvent.state: object expected");t.state=$root.ClassState.fromObject(e.state)}return null!=e.deviceId&&(t.deviceId=String(e.deviceId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.state=null,r.deviceId=""),null!=e.state&&e.hasOwnProperty("state")&&(r.state=$root.ClassState.toObject(e.state,t)),null!=e.deviceId&&e.hasOwnProperty("deviceId")&&(r.deviceId=e.deviceId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ClassEndedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(8).uint64(e.timestamp),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ClassEndedEvent;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.timestamp=e.uint64();else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high))?"timestamp: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.ClassEndedEvent)return e;var t=new $root.ClassEndedEvent;return null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!0:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if($util.Long){var n=new $util.Long(0,0,!0);r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timestamp=t.longs===String?"0":0;return null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber(!0):e.timestamp),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.DeviceConnectedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.role="",e.prototype.device=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(18).string(e.role),null!=e.device&&Object.hasOwnProperty.call(e,"device")&&$root.Device.encode(e.device,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.DeviceConnectedEvent;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.name=e.string();break;case 2:n.role=e.string();break;case 3:n.device=$root.Device.decode(e,e.uint32());break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!$util.isString(e.name))return"name: string expected";if(null!=e.role&&e.hasOwnProperty("role")&&!$util.isString(e.role))return"role: string expected";if(null!=e.device&&e.hasOwnProperty("device")){var t=$root.Device.verify(e.device);if(t)return"device."+t}return null},e.fromObject=function(e){if(e instanceof $root.DeviceConnectedEvent)return e;var t=new $root.DeviceConnectedEvent;if(null!=e.name&&(t.name=String(e.name)),null!=e.role&&(t.role=String(e.role)),null!=e.device){if("object"!=typeof e.device)throw TypeError(".DeviceConnectedEvent.device: object expected");t.device=$root.Device.fromObject(e.device)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.name="",r.role="",r.device=null),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.role&&e.hasOwnProperty("role")&&(r.role=e.role),null!=e.device&&e.hasOwnProperty("device")&&(r.device=$root.Device.toObject(e.device,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.DeviceDisconnectedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.deviceId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.deviceId&&Object.hasOwnProperty.call(e,"deviceId")&&t.uint32(10).string(e.deviceId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.DeviceDisconnectedEvent;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.deviceId=e.string();else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.deviceId&&e.hasOwnProperty("deviceId")&&!$util.isString(e.deviceId)?"deviceId: string expected":null},e.fromObject=function(e){if(e instanceof $root.DeviceDisconnectedEvent)return e;var t=new $root.DeviceDisconnectedEvent;return null!=e.deviceId&&(t.deviceId=String(e.deviceId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.deviceId=""),null!=e.deviceId&&e.hasOwnProperty("deviceId")&&(r.deviceId=e.deviceId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.HostChangedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.hostDeviceId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.hostDeviceId&&Object.hasOwnProperty.call(e,"hostDeviceId")&&t.uint32(10).string(e.hostDeviceId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.HostChangedEvent;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.hostDeviceId=e.string();else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.hostDeviceId&&e.hasOwnProperty("hostDeviceId")&&!$util.isString(e.hostDeviceId)?"hostDeviceId: string expected":null},e.fromObject=function(e){if(e instanceof $root.HostChangedEvent)return e;var t=new $root.HostChangedEvent;return null!=e.hostDeviceId&&(t.hostDeviceId=String(e.hostDeviceId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.hostDeviceId=""),null!=e.hostDeviceId&&e.hasOwnProperty("hostDeviceId")&&(r.hostDeviceId=e.hostDeviceId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ContentChangedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.content=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&$root.Content.encode(e.content,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ContentChangedEvent;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.content=$root.Content.decode(e,e.uint32());else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.content&&e.hasOwnProperty("content")){var t=$root.Content.verify(e.content);if(t)return"content."+t}return null},e.fromObject=function(e){if(e instanceof $root.ContentChangedEvent)return e;var t=new $root.ContentChangedEvent;if(null!=e.content){if("object"!=typeof e.content)throw TypeError(".ContentChangedEvent.content: object expected");t.content=$root.Content.fromObject(e.content)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.content=null),null!=e.content&&e.hasOwnProperty("content")&&(r.content=$root.Content.toObject(e.content,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ActivityStreamIdChangedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.deviceId="",e.prototype.activityStreamId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.deviceId&&Object.hasOwnProperty.call(e,"deviceId")&&t.uint32(10).string(e.deviceId),null!=e.activityStreamId&&Object.hasOwnProperty.call(e,"activityStreamId")&&t.uint32(18).string(e.activityStreamId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ActivityStreamIdChangedEvent;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.deviceId=e.string();break;case 2:n.activityStreamId=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.deviceId&&e.hasOwnProperty("deviceId")&&!$util.isString(e.deviceId)?"deviceId: string expected":null!=e.activityStreamId&&e.hasOwnProperty("activityStreamId")&&!$util.isString(e.activityStreamId)?"activityStreamId: string expected":null},e.fromObject=function(e){if(e instanceof $root.ActivityStreamIdChangedEvent)return e;var t=new $root.ActivityStreamIdChangedEvent;return null!=e.deviceId&&(t.deviceId=String(e.deviceId)),null!=e.activityStreamId&&(t.activityStreamId=String(e.activityStreamId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.deviceId="",r.activityStreamId=""),null!=e.deviceId&&e.hasOwnProperty("deviceId")&&(r.deviceId=e.deviceId),null!=e.activityStreamId&&e.hasOwnProperty("activityStreamId")&&(r.activityStreamId=e.activityStreamId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.TrophyRewardedToUserEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.userId="",e.prototype.trophy=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(10).string(e.userId),null!=e.trophy&&Object.hasOwnProperty.call(e,"trophy")&&$root.Trophy.encode(e.trophy,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.TrophyRewardedToUserEvent;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.userId=e.string();break;case 2:n.trophy=$root.Trophy.decode(e,e.uint32());break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.userId&&e.hasOwnProperty("userId")&&!$util.isString(e.userId))return"userId: string expected";if(null!=e.trophy&&e.hasOwnProperty("trophy")){var t=$root.Trophy.verify(e.trophy);if(t)return"trophy."+t}return null},e.fromObject=function(e){if(e instanceof $root.TrophyRewardedToUserEvent)return e;var t=new $root.TrophyRewardedToUserEvent;if(null!=e.userId&&(t.userId=String(e.userId)),null!=e.trophy){if("object"!=typeof e.trophy)throw TypeError(".TrophyRewardedToUserEvent.trophy: object expected");t.trophy=$root.Trophy.fromObject(e.trophy)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.userId="",r.trophy=null),null!=e.userId&&e.hasOwnProperty("userId")&&(r.userId=e.userId),null!=e.trophy&&e.hasOwnProperty("trophy")&&(r.trophy=$root.Trophy.toObject(e.trophy,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.TrophyRewardedToAllEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.trophy=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.trophy&&Object.hasOwnProperty.call(e,"trophy")&&$root.Trophy.encode(e.trophy,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.TrophyRewardedToAllEvent;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.trophy=$root.Trophy.decode(e,e.uint32());else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.trophy&&e.hasOwnProperty("trophy")){var t=$root.Trophy.verify(e.trophy);if(t)return"trophy."+t}return null},e.fromObject=function(e){if(e instanceof $root.TrophyRewardedToAllEvent)return e;var t=new $root.TrophyRewardedToAllEvent;if(null!=e.trophy){if("object"!=typeof e.trophy)throw TypeError(".TrophyRewardedToAllEvent.trophy: object expected");t.trophy=$root.Trophy.fromObject(e.trophy)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.trophy=null),null!=e.trophy&&e.hasOwnProperty("trophy")&&(r.trophy=$root.Trophy.toObject(e.trophy,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.NewChatMessageEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.chatMessage=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.chatMessage&&Object.hasOwnProperty.call(e,"chatMessage")&&$root.ChatMessage.encode(e.chatMessage,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.NewChatMessageEvent;e.pos<r;){var o=e.uint32();if(o>>>3==1)n.chatMessage=$root.ChatMessage.decode(e,e.uint32());else e.skipType(7&o)}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.chatMessage&&e.hasOwnProperty("chatMessage")){var t=$root.ChatMessage.verify(e.chatMessage);if(t)return"chatMessage."+t}return null},e.fromObject=function(e){if(e instanceof $root.NewChatMessageEvent)return e;var t=new $root.NewChatMessageEvent;if(null!=e.chatMessage){if("object"!=typeof e.chatMessage)throw TypeError(".NewChatMessageEvent.chatMessage: object expected");t.chatMessage=$root.ChatMessage.fromObject(e.chatMessage)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.chatMessage=null),null!=e.chatMessage&&e.hasOwnProperty("chatMessage")&&(r.chatMessage=$root.ChatMessage.toObject(e.chatMessage,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ClassState=function(){function e(e){if(this.users={},this.devices={},this.chatMessages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.users=$util.emptyObject,e.prototype.devices=$util.emptyObject,e.prototype.chatMessages=$util.emptyArray,e.prototype.content=null,e.prototype.hostDeviceId="",e.prototype.classEndedTime=$util.Long?$util.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.users&&Object.hasOwnProperty.call(e,"users"))for(var r=Object.keys(e.users),n=0;n<r.length;++n)t.uint32(10).fork().uint32(10).string(r[n]),$root.User.encode(e.users[r[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.devices&&Object.hasOwnProperty.call(e,"devices"))for(r=Object.keys(e.devices),n=0;n<r.length;++n)t.uint32(18).fork().uint32(10).string(r[n]),$root.Device.encode(e.devices[r[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.chatMessages&&e.chatMessages.length)for(n=0;n<e.chatMessages.length;++n)$root.ChatMessage.encode(e.chatMessages[n],t.uint32(26).fork()).ldelim();return null!=e.content&&Object.hasOwnProperty.call(e,"content")&&$root.Content.encode(e.content,t.uint32(34).fork()).ldelim(),null!=e.hostDeviceId&&Object.hasOwnProperty.call(e,"hostDeviceId")&&t.uint32(42).string(e.hostDeviceId),null!=e.classEndedTime&&Object.hasOwnProperty.call(e,"classEndedTime")&&t.uint32(48).uint64(e.classEndedTime),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,o=void 0===t?e.len:e.pos+t,i=new $root.ClassState;e.pos<o;){var s=e.uint32();switch(s>>>3){case 1:i.users===$util.emptyObject&&(i.users={});var a=e.uint32()+e.pos;for(r="",n=null;e.pos<a;){switch((c=e.uint32())>>>3){case 1:r=e.string();break;case 2:n=$root.User.decode(e,e.uint32());break;default:e.skipType(7&c)}}i.users[r]=n;break;case 2:i.devices===$util.emptyObject&&(i.devices={});a=e.uint32()+e.pos;for(r="",n=null;e.pos<a;){var c;switch((c=e.uint32())>>>3){case 1:r=e.string();break;case 2:n=$root.Device.decode(e,e.uint32());break;default:e.skipType(7&c)}}i.devices[r]=n;break;case 3:i.chatMessages&&i.chatMessages.length||(i.chatMessages=[]),i.chatMessages.push($root.ChatMessage.decode(e,e.uint32()));break;case 4:i.content=$root.Content.decode(e,e.uint32());break;case 5:i.hostDeviceId=e.string();break;case 6:i.classEndedTime=e.uint64();break;default:e.skipType(7&s)}}return i},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.users&&e.hasOwnProperty("users")){if(!$util.isObject(e.users))return"users: object expected";for(var t=Object.keys(e.users),r=0;r<t.length;++r){if(n=$root.User.verify(e.users[t[r]]))return"users."+n}}if(null!=e.devices&&e.hasOwnProperty("devices")){if(!$util.isObject(e.devices))return"devices: object expected";for(t=Object.keys(e.devices),r=0;r<t.length;++r){if(n=$root.Device.verify(e.devices[t[r]]))return"devices."+n}}if(null!=e.chatMessages&&e.hasOwnProperty("chatMessages")){if(!Array.isArray(e.chatMessages))return"chatMessages: array expected";for(r=0;r<e.chatMessages.length;++r){if(n=$root.ChatMessage.verify(e.chatMessages[r]))return"chatMessages."+n}}var n;if(null!=e.content&&e.hasOwnProperty("content")&&(n=$root.Content.verify(e.content)))return"content."+n;return null!=e.hostDeviceId&&e.hasOwnProperty("hostDeviceId")&&!$util.isString(e.hostDeviceId)?"hostDeviceId: string expected":null!=e.classEndedTime&&e.hasOwnProperty("classEndedTime")&&!($util.isInteger(e.classEndedTime)||e.classEndedTime&&$util.isInteger(e.classEndedTime.low)&&$util.isInteger(e.classEndedTime.high))?"classEndedTime: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.ClassState)return e;var t=new $root.ClassState;if(e.users){if("object"!=typeof e.users)throw TypeError(".ClassState.users: object expected");t.users={};for(var r=Object.keys(e.users),n=0;n<r.length;++n){if("object"!=typeof e.users[r[n]])throw TypeError(".ClassState.users: object expected");t.users[r[n]]=$root.User.fromObject(e.users[r[n]])}}if(e.devices){if("object"!=typeof e.devices)throw TypeError(".ClassState.devices: object expected");t.devices={};for(r=Object.keys(e.devices),n=0;n<r.length;++n){if("object"!=typeof e.devices[r[n]])throw TypeError(".ClassState.devices: object expected");t.devices[r[n]]=$root.Device.fromObject(e.devices[r[n]])}}if(e.chatMessages){if(!Array.isArray(e.chatMessages))throw TypeError(".ClassState.chatMessages: array expected");t.chatMessages=[];for(n=0;n<e.chatMessages.length;++n){if("object"!=typeof e.chatMessages[n])throw TypeError(".ClassState.chatMessages: object expected");t.chatMessages[n]=$root.ChatMessage.fromObject(e.chatMessages[n])}}if(null!=e.content){if("object"!=typeof e.content)throw TypeError(".ClassState.content: object expected");t.content=$root.Content.fromObject(e.content)}return null!=e.hostDeviceId&&(t.hostDeviceId=String(e.hostDeviceId)),null!=e.classEndedTime&&($util.Long?(t.classEndedTime=$util.Long.fromValue(e.classEndedTime)).unsigned=!0:"string"==typeof e.classEndedTime?t.classEndedTime=parseInt(e.classEndedTime,10):"number"==typeof e.classEndedTime?t.classEndedTime=e.classEndedTime:"object"==typeof e.classEndedTime&&(t.classEndedTime=new $util.LongBits(e.classEndedTime.low>>>0,e.classEndedTime.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var r,n={};if((t.arrays||t.defaults)&&(n.chatMessages=[]),(t.objects||t.defaults)&&(n.users={},n.devices={}),t.defaults)if(n.content=null,n.hostDeviceId="",$util.Long){var o=new $util.Long(0,0,!0);n.classEndedTime=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.classEndedTime=t.longs===String?"0":0;if(e.users&&(r=Object.keys(e.users)).length){n.users={};for(var i=0;i<r.length;++i)n.users[r[i]]=$root.User.toObject(e.users[r[i]],t)}if(e.devices&&(r=Object.keys(e.devices)).length){n.devices={};for(i=0;i<r.length;++i)n.devices[r[i]]=$root.Device.toObject(e.devices[r[i]],t)}if(e.chatMessages&&e.chatMessages.length){n.chatMessages=[];for(i=0;i<e.chatMessages.length;++i)n.chatMessages[i]=$root.ChatMessage.toObject(e.chatMessages[i],t)}return null!=e.content&&e.hasOwnProperty("content")&&(n.content=$root.Content.toObject(e.content,t)),null!=e.hostDeviceId&&e.hasOwnProperty("hostDeviceId")&&(n.hostDeviceId=e.hostDeviceId),null!=e.classEndedTime&&e.hasOwnProperty("classEndedTime")&&("number"==typeof e.classEndedTime?n.classEndedTime=t.longs===String?String(e.classEndedTime):e.classEndedTime:n.classEndedTime=t.longs===String?$util.Long.prototype.toString.call(e.classEndedTime):t.longs===Number?new $util.LongBits(e.classEndedTime.low>>>0,e.classEndedTime.high>>>0).toNumber(!0):e.classEndedTime),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.User=function(){function e(e){if(this.deviceIds=[],this.trophies=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.name="",e.prototype.role="",e.prototype.deviceIds=$util.emptyArray,e.prototype.trophies=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(26).string(e.role),null!=e.deviceIds&&e.deviceIds.length)for(var r=0;r<e.deviceIds.length;++r)t.uint32(34).string(e.deviceIds[r]);if(null!=e.trophies&&e.trophies.length)for(r=0;r<e.trophies.length;++r)$root.Trophy.encode(e.trophies[r],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.User;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.id=e.string();break;case 2:n.name=e.string();break;case 3:n.role=e.string();break;case 4:n.deviceIds&&n.deviceIds.length||(n.deviceIds=[]),n.deviceIds.push(e.string());break;case 5:n.trophies&&n.trophies.length||(n.trophies=[]),n.trophies.push($root.Trophy.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id))return"id: string expected";if(null!=e.name&&e.hasOwnProperty("name")&&!$util.isString(e.name))return"name: string expected";if(null!=e.role&&e.hasOwnProperty("role")&&!$util.isString(e.role))return"role: string expected";if(null!=e.deviceIds&&e.hasOwnProperty("deviceIds")){if(!Array.isArray(e.deviceIds))return"deviceIds: array expected";for(var t=0;t<e.deviceIds.length;++t)if(!$util.isString(e.deviceIds[t]))return"deviceIds: string[] expected"}if(null!=e.trophies&&e.hasOwnProperty("trophies")){if(!Array.isArray(e.trophies))return"trophies: array expected";for(t=0;t<e.trophies.length;++t){var r=$root.Trophy.verify(e.trophies[t]);if(r)return"trophies."+r}}return null},e.fromObject=function(e){if(e instanceof $root.User)return e;var t=new $root.User;if(null!=e.id&&(t.id=String(e.id)),null!=e.name&&(t.name=String(e.name)),null!=e.role&&(t.role=String(e.role)),e.deviceIds){if(!Array.isArray(e.deviceIds))throw TypeError(".User.deviceIds: array expected");t.deviceIds=[];for(var r=0;r<e.deviceIds.length;++r)t.deviceIds[r]=String(e.deviceIds[r])}if(e.trophies){if(!Array.isArray(e.trophies))throw TypeError(".User.trophies: array expected");t.trophies=[];for(r=0;r<e.trophies.length;++r){if("object"!=typeof e.trophies[r])throw TypeError(".User.trophies: object expected");t.trophies[r]=$root.Trophy.fromObject(e.trophies[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.deviceIds=[],r.trophies=[]),t.defaults&&(r.id="",r.name="",r.role=""),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.role&&e.hasOwnProperty("role")&&(r.role=e.role),e.deviceIds&&e.deviceIds.length){r.deviceIds=[];for(var n=0;n<e.deviceIds.length;++n)r.deviceIds[n]=e.deviceIds[n]}if(e.trophies&&e.trophies.length){r.trophies=[];for(n=0;n<e.trophies.length;++n)r.trophies[n]=$root.Trophy.toObject(e.trophies[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.Trophy=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.type="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(8).uint64(e.timestamp),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(18).string(e.type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.Trophy;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.timestamp=e.uint64();break;case 2:n.type=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high))?"timestamp: integer|Long expected":null!=e.type&&e.hasOwnProperty("type")&&!$util.isString(e.type)?"type: string expected":null},e.fromObject=function(e){if(e instanceof $root.Trophy)return e;var t=new $root.Trophy;return null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!0:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber(!0))),null!=e.type&&(t.type=String(e.type)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!0);r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timestamp=t.longs===String?"0":0;r.type=""}return null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber(!0):e.timestamp),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.Device=function(){function e(e){if(this.webRtcStreamIds=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.userId="",e.prototype.activityStreamId="",e.prototype.webRtcStreamIds=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.activityStreamId&&Object.hasOwnProperty.call(e,"activityStreamId")&&t.uint32(26).string(e.activityStreamId),null!=e.webRtcStreamIds&&e.webRtcStreamIds.length)for(var r=0;r<e.webRtcStreamIds.length;++r)t.uint32(34).string(e.webRtcStreamIds[r]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.Device;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.id=e.string();break;case 2:n.userId=e.string();break;case 3:n.activityStreamId=e.string();break;case 4:n.webRtcStreamIds&&n.webRtcStreamIds.length||(n.webRtcStreamIds=[]),n.webRtcStreamIds.push(e.string());break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id))return"id: string expected";if(null!=e.userId&&e.hasOwnProperty("userId")&&!$util.isString(e.userId))return"userId: string expected";if(null!=e.activityStreamId&&e.hasOwnProperty("activityStreamId")&&!$util.isString(e.activityStreamId))return"activityStreamId: string expected";if(null!=e.webRtcStreamIds&&e.hasOwnProperty("webRtcStreamIds")){if(!Array.isArray(e.webRtcStreamIds))return"webRtcStreamIds: array expected";for(var t=0;t<e.webRtcStreamIds.length;++t)if(!$util.isString(e.webRtcStreamIds[t]))return"webRtcStreamIds: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.Device)return e;var t=new $root.Device;if(null!=e.id&&(t.id=String(e.id)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.activityStreamId&&(t.activityStreamId=String(e.activityStreamId)),e.webRtcStreamIds){if(!Array.isArray(e.webRtcStreamIds))throw TypeError(".Device.webRtcStreamIds: array expected");t.webRtcStreamIds=[];for(var r=0;r<e.webRtcStreamIds.length;++r)t.webRtcStreamIds[r]=String(e.webRtcStreamIds[r])}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.webRtcStreamIds=[]),t.defaults&&(r.id="",r.userId="",r.activityStreamId=""),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.userId&&e.hasOwnProperty("userId")&&(r.userId=e.userId),null!=e.activityStreamId&&e.hasOwnProperty("activityStreamId")&&(r.activityStreamId=e.activityStreamId),e.webRtcStreamIds&&e.webRtcStreamIds.length){r.webRtcStreamIds=[];for(var n=0;n<e.webRtcStreamIds.length;++n)r.webRtcStreamIds[n]=e.webRtcStreamIds[n]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.ChatMessage=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.userId="",e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.text="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(10).string(e.userId),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(16).uint64(e.timestamp),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(26).string(e.text),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.ChatMessage;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.userId=e.string();break;case 2:n.timestamp=e.uint64();break;case 3:n.text=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util.isString(e.userId)?"userId: string expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high))?"timestamp: integer|Long expected":null!=e.text&&e.hasOwnProperty("text")&&!$util.isString(e.text)?"text: string expected":null},e.fromObject=function(e){if(e instanceof $root.ChatMessage)return e;var t=new $root.ChatMessage;return null!=e.userId&&(t.userId=String(e.userId)),null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!0:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber(!0))),null!=e.text&&(t.text=String(e.text)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(r.userId="",$util.Long){var n=new $util.Long(0,0,!0);r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timestamp=t.longs===String?"0":0;r.text=""}return null!=e.userId&&e.hasOwnProperty("userId")&&(r.userId=e.userId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber(!0):e.timestamp),null!=e.text&&e.hasOwnProperty("text")&&(r.text=e.text),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),$root.Content=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type="",e.prototype.contentLocation="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(10).string(e.type),null!=e.contentLocation&&Object.hasOwnProperty.call(e,"contentLocation")&&t.uint32(18).string(e.contentLocation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.Content;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.type=e.string();break;case 2:n.contentLocation=e.string();break;default:e.skipType(7&o)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.type&&e.hasOwnProperty("type")&&!$util.isString(e.type)?"type: string expected":null!=e.contentLocation&&e.hasOwnProperty("contentLocation")&&!$util.isString(e.contentLocation)?"contentLocation: string expected":null},e.fromObject=function(e){if(e instanceof $root.Content)return e;var t=new $root.Content;return null!=e.type&&(t.type=String(e.type)),null!=e.contentLocation&&(t.contentLocation=String(e.contentLocation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.type="",r.contentLocation=""),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),null!=e.contentLocation&&e.hasOwnProperty("contentLocation")&&(r.contentLocation=e.contentLocation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}();var protobuf=$root,eventemitter3={exports:{}},ConnectionStatus;!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,o=[];if(0===this._eventsCount)return o;for(n in e=this._events)t.call(e,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,s=new Array(i);o<i;o++)s[o]=n[o].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,o,i,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,d=this._events[a],l=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),l){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,o),!0;case 5:return d.fn.call(d.context,t,n,o,i),!0;case 6:return d.fn.call(d.context,t,n,o,i,s),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];d.fn.apply(d.context,c)}else{var f,p=d.length;for(u=0;u<p;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),l){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,n);break;case 4:d[u].fn.call(d[u].context,t,n,o);break;default:if(!c)for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];d[u].fn.apply(d[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,o){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||n&&a.context!==n||s(this,i);else{for(var c=0,u=[],d=a.length;c<d;c++)(a[c].fn!==t||o&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(eventemitter3),function(e){e[e.Connecting=0]="Connecting",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected"}(ConnectionStatus||(ConnectionStatus={}));const setConnectionError=createAction("setConnectionError"),connectionError=createReducer(!1,(e=>e.addCase(setConnectionError,((e,{payload:t})=>t)))),setConnectionStatus=createAction("setConnectionState"),connectionStatus=createReducer(ConnectionStatus.Disconnected,(e=>e.addCase(setConnectionStatus,((e,{payload:t})=>t)))),myDeviceId=createReducer(null,(e=>e.addCase(classActions.join,((e,{payload:t})=>t.deviceId)))),networkReducer=combineReducers({connectionStatus:connectionStatus,connectionError:connectionError,myDeviceId:myDeviceId}),newRequestId=e=>e;class Network{constructor(e,t,r){this.store=e,this.selector=t,this.ws=r,this.actionEmitter=new eventemitter3.exports.EventEmitter,this.pendingRequests=new Map,this.recieveMessageTimeoutTime=5e3,this.sendKeepAliveMessageInterval=1e3}onClassAction(e,t){const r=`${classSliceActionPrefix}/${e}`;return this.actionEmitter.addListener(r,t),()=>{this.actionEmitter.removeListener(r,t)}}async initWs(e){return this.ws||(this.ws=new Promise(((t,r)=>{this.store.dispatch(setConnectionStatus(ConnectionStatus.Connecting));const n=new WebSocket(e,["live"]);n.binaryType="arraybuffer",n.addEventListener("open",(e=>{console.log("open",e),t(n),this.store.dispatch(setConnectionError(!1)),this.store.dispatch(setConnectionStatus(ConnectionStatus.Connected)),this.resetNetworkSendTimeout(),this.resetNetworkRecieveTimeout()})),n.addEventListener("close",(e=>{console.log("close",e),this.ws=void 0,r(e),this.store.dispatch(setConnectionStatus(ConnectionStatus.Disconnected))})),n.addEventListener("error",(e=>{console.log("error",e),r(e),this.store.dispatch(setConnectionError(!0))})),n.addEventListener("message",(e=>{this.onNetworkMessage(n,e.data)}))}))),this.ws}async close(e=4500,t){(await this.ws)?.close(e,t)}async send(e){if(!this.ws)throw Error("websocket has not been initialised");const t=nanoid(),r=protobuf.ClassRequest.encode({requestId:t,...e}).finish();if(!await this._send(r))throw new Error("Failed to send");return new Promise(((e,r)=>this.pendingRequests.set(t,{resolve:e,reject:r})))}async _send(e){const t=await this.ws;return!!t&&(t.send(e),this.resetNetworkSendTimeout(),!0)}onNetworkMessage(e,t){if(this.resetNetworkRecieveTimeout(),t instanceof ArrayBuffer)try{if(t.byteLength<=0)return;const e=protobuf.ClassMessage.decode(new Uint8Array(t));e.response&&this.handleRequestPromise(e.response);const r=messageToClassAction(e);if(!r)return;this.store.dispatch(r);const n=this.selector(this.store.getState());this.actionEmitter.emit(r.type,r.payload,n)}catch(t){console.error(t),e.close(4400,"Parse error")}else e.close(4401,"Binary only protocol")}handleRequestPromise(e){if(!e.id)return void console.error("Recieved ClassResponse without an id");const t=newRequestId(e.id),r=this.pendingRequests.get(t);r?(this.pendingRequests.delete(t),e.error?r.reject(e.error):r.resolve()):console.error(`Recieved aknowledge(${t}) for unknown request`)}resetNetworkRecieveTimeout(){void 0!==this.recieveTimeoutReference&&clearTimeout(this.recieveTimeoutReference),this.recieveTimeoutReference=setTimeout((()=>this.close(4400,"timeout")),this.recieveMessageTimeoutTime)}resetNetworkSendTimeout(){this.keepAliveTimeoutReference&&clearTimeout(this.keepAliveTimeoutReference),this.keepAliveTimeoutReference=setTimeout((()=>this._send(new Uint8Array(0))),this.sendKeepAliveMessageInterval)}}function NetworkProvider({children:e,selector:t}){const r=useStore(),n=useMemo((()=>new Network(r,t)),[r,t]);return React.createElement(NetworkContext.Provider,{value:n},e)}const reducer=combineReducers({class:classReducer,network:networkReducer}),roles={Teacher:newUserRole("teacher"),Student:newUserRole("student")};function isTeacher({role:e}){return e===roles.Teacher}function isStudent({role:e}){return e===roles.Student}export{ConnectionStatus,ContentType,FeedbackType,INITIAL_ROOM_STATE,NetworkContext,NetworkProvider,QuickFeedbackType,actvityStreamIdChangedAction,classActions,classEndedAction,classReducer,classSlice,classSliceActionPrefix,connectionError,connectionStatus,contentChangedAction,deviceConnectedAction,deviceDisconnectedAction,hostChangedAction,isStudent,isTeacher,joinAction,messageToClassAction,myDeviceId,networkReducer,newActivityStreamId,newChatMessageAction,newDeviceId,newTimestamp,newTrophyType,newUserId,newUserRole,newWebRtcStreamId,reducer,roles,setConnectionError,setConnectionStatus,trophyRewardedToAllAction,trophyRewardedToUserAction,useEndClass,useJoinClass,useLeaveClass,useNetworkHandler,useNetworkState,useRewardTrophyToAll,useRewardTrophyToUser,useSendChatMessage,useSetActvityStreamId,useSetContent,useSetHost};
//# sourceMappingURL=ui.js.map
